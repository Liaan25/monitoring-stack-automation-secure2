# üöÄ Monitoring Stack Automation

> *–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è —Å—Ç–µ–∫–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –¥–ª—è enterprise*

[![Version](https://img.shields.io/badge/version-3.0.0-blue.svg)](PROJECT_INFO.md)
[![Status](https://img.shields.io/badge/status-production--ready-green.svg)](README.md)
[![Security](https://img.shields.io/badge/security-enterprise--grade-brightgreen.svg)](SECURITY.md)

---

## üìã –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ

- [–û –ø—Ä–æ–µ–∫—Ç–µ](#-–æ–±–∑–æ—Ä-–ø—Ä–æ–µ–∫—Ç–∞)
- [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏](#-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞-–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏)
- [–ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞](PROJECT_INFO.md) üì¶
- [–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç](#-–±—ã—Å—Ç—Ä—ã–π-—Å—Ç–∞—Ä—Ç)
- [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞](#-—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–ø—Ä–æ–µ–∫—Ç–∞)
- [–ü—Ä–æ—Ü–µ—Å—Å —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è](#-–ø—Ä–æ—Ü–µ—Å—Å-—Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è)
- [–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Jenkins](#-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è-jenkins)
- [–†–∞–±–æ—Ç–∞ —Å–∫—Ä–∏–ø—Ç–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ](#-—Ä–∞–±–æ—Ç–∞-—Å–∫—Ä–∏–ø—Ç–∞-–Ω–∞-—Å–µ—Ä–≤–µ—Ä–µ)
- [–°–∏—Å—Ç–µ–º–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏](#-—Å–∏—Å—Ç–µ–º–∞-–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏)
- [–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥](#-—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ-–∏-–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥)
- [–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∏ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º](#-–¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞-–∏-—É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ-–ø—Ä–æ–±–ª–µ–º)
- [FAQ](#-faq)

---

## üéØ –û–±–∑–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞

–≠—Ç–æ **–ø–æ–ª–Ω–æ—Å—Ç—å—é –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ** –¥–ª—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è —Å—Ç–µ–∫–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –Ω–∞ Linux-—Å–µ—Ä–≤–µ—Ä–∞—Ö —á–µ—Ä–µ–∑ Jenkins CI/CD —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–º —É—Ä–æ–≤–Ω–µ–º –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.

### –ß—Ç–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–µ—Ç—Å—è

- **NetApp Harvest** ‚Äì —Å–±–æ—Ä—â–∏–∫ –º–µ—Ç—Ä–∏–∫ NetApp ONTAP –∏ Unix —Å–∏—Å—Ç–µ–º
- **Prometheus** ‚Äì —Å–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤
- **Grafana** ‚Äì –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –º–µ—Ç—Ä–∏–∫ –∏ –¥–∞—à–±–æ—Ä–¥—ã
- **HashiCorp Vault Agent** ‚Äì –±–µ–∑–æ–ø–∞—Å–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ–∫—Ä–µ—Ç–∞–º–∏

### –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

‚úÖ **–ü–æ–ª–Ω–∞—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è** ‚Äì –æ—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø–∞–∫–µ—Ç–æ–≤ –¥–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–∞—à–±–æ—Ä–¥–æ–≤  
‚úÖ **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –ø–æ –¥–∏–∑–∞–π–Ω—É** ‚Äì –≤—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ –æ–±–µ—Ä—Ç–∫–∏ —Å –±–µ–ª—ã–º–∏ —Å–ø–∏—Å–∫–∞–º–∏  
‚úÖ **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏** ‚Äì RLM, Vault, SberCA  
‚úÖ **mTLS** ‚Äì –ø–æ–ª–Ω–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π —Å –≤–∑–∞–∏–º–Ω–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π  
‚úÖ **–ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å** ‚Äì –º–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –º–Ω–æ–≥–æ–∫—Ä–∞—Ç–Ω–æ –±–µ–∑ –ø–æ–±–æ—á–Ω—ã—Ö —ç—Ñ—Ñ–µ–∫—Ç–æ–≤  
‚úÖ **–î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** ‚Äì –ø–æ–ª–Ω–∞—è —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

### –î–ª—è –∫–æ–≥–æ —ç—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç

- **üõ°Ô∏è –°–ª—É–∂–±—ã –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏** ‚Äì –¥–µ—Ç–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- **üíª –ü—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç—ã** ‚Äì —á–∏—Å—Ç—ã–π –∫–æ–¥ —Å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏, –º–æ–¥—É–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- **üîß –°–∏—Å—Ç–µ–º–Ω—ã–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã** ‚Äì –≥–æ—Ç–æ–≤–æ–µ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é —Ä–µ—à–µ–Ω–∏–µ —Å –ø–æ–Ω—è—Ç–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–æ–π
- **üìä DevOps –∏–Ω–∂–µ–Ω–µ—Ä—ã** ‚Äì CI/CD –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è, Infrastructure as Code

---

## üîí –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### –û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã

#### 1. **–ú–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π**
- Jenkins —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ–¥ –æ–±—ã—á–Ω–æ–π —É—á–µ—Ç–Ω–æ–π –∑–∞–ø–∏—Å—å—é
- –¢–æ–ª—å–∫–æ –æ–¥–∏–Ω `sudo` –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞
- –í—Å–µ –æ–ø–∞—Å–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω—ã –≤ –æ–±–µ—Ä—Ç–∫–∞—Ö

#### 2. **–ë–µ–ª—ã–µ —Å–ø–∏—Å–∫–∏ –≤–µ–∑–¥–µ**
- URL –¥–ª—è RLM API (—Ç–æ–ª—å–∫–æ `https://api.rlm.sbrf.ru`)
- –ü–æ—Ä—Ç—ã (1-65535 —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π)
- –ü—É—Ç–∏ —Ñ–∞–π–ª–æ–≤ (—Ç–æ–ª—å–∫–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏)
- IP-–∞–¥—Ä–µ—Å–∞ (IPv4 —Ñ–æ—Ä–º–∞—Ç)

#### 3. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –∫–æ–¥–∞ (SHA256)**
```
–û–±–µ—Ä—Ç–∫–∞ ‚Üí –õ–∞—É–Ω—á–µ—Ä ‚Üí –ü—Ä–æ–≤–µ—Ä–∫–∞ SHA256 ‚Üí –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
```
–ü—Ä–∏ –ª—é–±–æ–º –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∫–æ–¥–∞ –æ–±–µ—Ä—Ç–∫–∏ ‚Äì –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –æ—Ç–∫–∞–∑ –≤ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏

#### 4. **–°–µ–∫—Ä–µ—Ç—ã –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –ø–æ–ø–∞–¥–∞—é—Ç –≤ –ª–æ–≥–∏**
- –•—Ä–∞–Ω—è—Ç—Å—è –≤ Vault
- –ü–µ—Ä–µ–¥–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- –û—á–∏—â–∞—é—Ç—Å—è –ø–æ—Å–ª–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è (`unset`)
- –ù–µ –≤—ã–≤–æ–¥—è—Ç—Å—è –≤ stdout/stderr

#### 5. **–ê—É–¥–∏—Ç –≤—Å–µ—Ö –¥–µ–π—Å—Ç–≤–∏–π**
```
[2026-01-23 10:30:15] [STEP] –ù–∞—á–∞–ª–æ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ Prometheus
[2026-01-23 10:30:16] [RLM_WRAPPER] –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏: LINUX_RPM_INSTALLER
[2026-01-23 10:30:17] [SUCCESS] ‚úÖ –ó–∞–¥–∞—á–∞ —Å–æ–∑–¥–∞–Ω–∞. ID: 12345
```

### –°—Ö–µ–º–∞ –∑–∞—â–∏—Ç—ã

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                         Jenkins                              ‚îÇ
‚îÇ  (clearAgent/masterLin, –æ–±—ã—á–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å)               ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                 ‚îÇ
                 ‚îú‚îÄ1. –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–µ–∫—Ä–µ—Ç–æ–≤ –∏–∑ Vault
                 ‚îÇ   (temp_data_cred.json, –æ—á–∏—â–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ)
                 ‚îÇ
                 ‚îú‚îÄ2. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ª–∞—É–Ω—á–µ—Ä–æ–≤ —Å SHA256
                 ‚îÇ   (build-integrity-checkers.sh)
                 ‚îÇ
                 ‚îú‚îÄ3. –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ SCP
                 ‚îÇ   ‚îî‚îÄ> –¶–µ–ª–µ–≤–æ–π —Å–µ—Ä–≤–µ—Ä: /tmp/deploy-monitoring/
                 ‚îÇ
                 ‚îî‚îÄ4. –ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π sudo
                     ‚îî‚îÄ> sudo bash install-monitoring-stack.sh
                         ‚îÇ
                         ‚îú‚îÄ> iptables_launcher.sh
                         ‚îÇ   ‚îî‚îÄ> SHA256 ‚úì ‚Üí firewall-manager.sh
                         ‚îÇ       ‚îî‚îÄ> –ë–µ–ª—ã–π —Å–ø–∏—Å–æ–∫ –ø–æ—Ä—Ç–æ–≤ ‚úì
                         ‚îÇ
                         ‚îú‚îÄ> rlm_launcher.sh
                         ‚îÇ   ‚îî‚îÄ> SHA256 ‚úì ‚Üí rlm-api-wrapper.sh
                         ‚îÇ       ‚îî‚îÄ> –ë–µ–ª—ã–π —Å–ø–∏—Å–æ–∫ URL ‚úì
                         ‚îÇ
                         ‚îú‚îÄ> grafana_launcher.sh
                         ‚îÇ   ‚îî‚îÄ> SHA256 ‚úì ‚Üí grafana-api-wrapper.sh
                         ‚îÇ       ‚îî‚îÄ> –ë–µ–ª—ã–π —Å–ø–∏—Å–æ–∫ –æ–ø–µ—Ä–∞—Ü–∏–π ‚úì
                         ‚îÇ
                         ‚îî‚îÄ> config-writer_launcher.sh
                             ‚îî‚îÄ> SHA256 ‚úì ‚Üí config-writer.sh
                                 ‚îî‚îÄ> –ë–µ–ª—ã–π —Å–ø–∏—Å–æ–∫ –ø—É—Ç–µ–π ‚úì
```

> üìñ **–î–µ—Ç–∞–ª–∏ –¥–ª—è –ò–ë:** –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –≤ [`SECURITY.md`](SECURITY.md)

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

#### –ù–∞ Jenkins-–∞–≥–µ–Ω—Ç–µ:
- Jenkins —Å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–º –ø–ª–∞–≥–∏–Ω–æ–º `withVault`
- SSH –∫–ª—é—á –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ —Ü–µ–ª–µ–≤–æ–º—É —Å–µ—Ä–≤–µ—Ä—É
- –î–æ—Å—Ç—É–ø –∫ HashiCorp Vault
- Git –¥–ª—è –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

#### –ù–∞ —Ü–µ–ª–µ–≤–æ–º —Å–µ—Ä–≤–µ—Ä–µ:
- OS Linux (RHEL/CentOS 8+)
- –î–æ—Å—Ç—É–ø –∫ RLM API
- Passwordless sudo –¥–ª—è CI-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –û—Ç–∫—Ä—ã—Ç—ã–µ –ø–æ—Ä—Ç—ã: 3000 (Grafana), 9090 (Prometheus)

### –®–∞–≥ 1: –°–æ–∑–¥–∞–Ω–∏–µ —É—á–µ—Ç–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π (—á–µ—Ä–µ–∑ RLM/IDM)

```bash
# –í—ã—á–∏—Å–ª—è–µ–º KAE –∏–∑ NAMESPACE_CI
# –ü—Ä–∏–º–µ—Ä: NAMESPACE_CI="CI04523276_CI10742292"
KAE="CI10742292"  # –≤—Ç–æ—Ä–æ–π —ç–ª–µ–º–µ–Ω—Ç –ø–æ—Å–ª–µ "_"

# –°–æ–∑–¥–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ RLM/IDM (–ù–ï —Å–∫—Ä–∏–ø—Ç–æ–º):
# 1. ${KAE}-lnx-mon_sys  - —Å–µ—Ä–≤–∏—Å–Ω–∞—è –£–ó (nologin)
# 2. ${KAE}-lnx-mon_ci   - CI/–¢–£–ó –¥–ª—è Jenkins
```

### –®–∞–≥ 2: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ sudoers –Ω–∞ —Ü–µ–ª–µ–≤–æ–º —Å–µ—Ä–≤–µ—Ä–µ

```bash
# –î–æ–±–∞–≤—å—Ç–µ –≤ /etc/sudoers.d/monitoring (–∫–∞–∫ root):
cat > /etc/sudoers.d/monitoring << 'EOF'
Defaults    env_reset
Defaults    secure_path="/usr/sbin:/usr/bin:/sbin:/bin"

CI10742292-lnx-mon_ci ALL=(ALL:ALL) NOEXEC: NOPASSWD: /bin/bash /tmp/deploy-monitoring/install-monitoring-stack.sh
EOF

chmod 440 /etc/sudoers.d/monitoring
visudo -cf /etc/sudoers.d/monitoring
```

> ‚ö†Ô∏è **–í–∞–∂–Ω–æ:** –ó–∞–º–µ–Ω–∏—Ç–µ `CI10742292-lnx-mon_ci` –Ω–∞ –≤–∞—à—É CI-—É—á–µ—Ç–Ω—É—é –∑–∞–ø–∏—Å—å

### –®–∞–≥ 3: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ–∫—Ä–µ—Ç–æ–≤ –≤ Vault

```bash
# –°—Ç—Ä—É–∫—Ç—É—Ä–∞ KV-—Å–µ–∫—Ä–µ—Ç–æ–≤ –≤ Vault:

# 1. vault-agent (role_id, secret_id)
vault kv put secret/${NAMESPACE_CI}/vault-agent \
  role_id="xxx" \
  secret_id="yyy"

# 2. RPM URL-—ã (harvest, prometheus, grafana)
vault kv put secret/${NAMESPACE_CI}/rpm_url \
  harvest="http://artifactory.../harvest-rpm.rpm" \
  prometheus="http://artifactory.../prometheus-rpm.rpm" \
  grafana="http://artifactory.../grafana-rpm.rpm"

# 3. NetApp SSH (addr, user, pass)
vault kv put secret/${NAMESPACE_CI}/netapp_ssh \
  addr="netapp-cluster.example.com" \
  user="admin" \
  pass="secret"

# 4. Grafana Web (user, pass)
vault kv put secret/${NAMESPACE_CI}/grafana_web \
  user="admin" \
  pass="admin"

# 5. SberCA Certificate (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)
vault kv put secret/${NAMESPACE_CI}/sberca_cert \
  cert="..." \
  key="..."
```

### –®–∞–≥ 4: –°–æ–∑–¥–∞–Ω–∏–µ Jenkins Pipeline

```groovy
// –í Jenkins: New Item ‚Üí Pipeline
// Pipeline script from SCM:
//   SCM: Git
//   Repository URL: [URL —ç—Ç–æ–≥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è]
//   Script Path: Jenkinsfile

// –ü–∞—Ä–∞–º–µ—Ç—Ä—ã (–≤ Jenkinsfile —É–∂–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã):
// - SERVER_ADDRESS: tvlds-mvp001939.cloud.delta.sbrf.ru
// - SSH_CREDENTIALS_ID: jenkins-ssh-key
// - SEC_MAN_ADDR: vault.sbrf.ru
// - NAMESPACE_CI: CI04523276_CI10742292
// - RLM_API_URL: https://api.rlm.sbrf.ru
// ... (—Å–º. –ø–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ –≤ Jenkinsfile)
```

### –®–∞–≥ 5: –ó–∞–ø—É—Å–∫ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è

```
1. –û—Ç–∫—Ä–æ–π—Ç–µ Jenkins Job
2. "Build with Parameters"
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
4. "Build"
5. –ù–∞–±–ª—é–¥–∞–π—Ç–µ –∑–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å–æ–º (10-15 –º–∏–Ω—É—Ç)
```

### –®–∞–≥ 6: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞

```bash
# –ù–∞ —Ü–µ–ª–µ–≤–æ–º —Å–µ—Ä–≤–µ—Ä–µ:
systemctl status prometheus grafana-server harvest

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ä—Ç–æ–≤:
ss -tln | grep -E ':(3000|9090|12990|12991)'

# –î–æ—Å—Ç—É–ø –∫ UI:
# Grafana:    https://SERVER_ADDRESS:3000
# Prometheus: https://SERVER_ADDRESS:9090
```

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
.
‚îú‚îÄ‚îÄ README.md                          # üìñ –≠—Ç–æ—Ç —Ñ–∞–π–ª
‚îú‚îÄ‚îÄ SECURITY.md                        # üîí –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –¥–ª—è –ò–ë
‚îú‚îÄ‚îÄ Jenkinsfile                        # üîÑ –î–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω—ã–π CI/CD –ø–∞–π–ø–ª–∞–π–Ω
‚îú‚îÄ‚îÄ install-monitoring-stack.sh        # üöÄ –û—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è (4025 —Å—Ç—Ä–æ–∫)
‚îú‚îÄ‚îÄ sudoers.example                    # ‚öôÔ∏è  –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–±–æ—á–∏–π sudoers
‚îú‚îÄ‚îÄ sudoers.template                   # üìù –†–∞–∑–≤–µ—Ä–Ω—É—Ç—ã–π —à–∞–±–ª–æ–Ω sudoers –¥–ª—è –ò–ë
‚îî‚îÄ‚îÄ wrappers/                          # üõ°Ô∏è –°–∫—Ä–∏–ø—Ç—ã-–æ–±–µ—Ä—Ç–∫–∏ —Å –±–µ–ª—ã–º–∏ —Å–ø–∏—Å–∫–∞–º–∏
    ‚îú‚îÄ‚îÄ build-integrity-checkers.sh    #   ‚îî‚îÄ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ª–∞—É–Ω—á–µ—Ä–æ–≤ —Å SHA256
    ‚îú‚îÄ‚îÄ config-writer.sh               #   ‚îî‚îÄ –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –∑–∞–ø–∏—Å—å –∫–æ–Ω—Ñ–∏–≥–æ–≤
    ‚îú‚îÄ‚îÄ firewall-manager.sh            #   ‚îî‚îÄ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ firewall
    ‚îú‚îÄ‚îÄ grafana-api-wrapper.sh         #   ‚îî‚îÄ –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å Grafana API
    ‚îî‚îÄ‚îÄ rlm-api-wrapper.sh             #   ‚îî‚îÄ –†–∞–±–æ—Ç–∞ —Å RLM API
```

### –û–ø–∏—Å–∞–Ω–∏–µ –∫–ª—é—á–µ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤

| –§–∞–π–ª | –°—Ç—Ä–æ–∫ | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|------|-------|------------|
| `install-monitoring-stack.sh` | 4025 | –û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ |
| `Jenkinsfile` | 667 | CI/CD –ø–∞–π–ø–ª–∞–π–Ω —Å 10 —Å—Ç–µ–π–¥–∂–∞–º–∏ |
| `SECURITY.md` | 157 | –ö–æ–Ω—Å–ø–µ–∫—Ç –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –¥–ª—è –∞—É–¥–∏—Ç–∞ –ò–ë |
| `wrappers/*.sh` | ~500 | 5 —Å–∫—Ä–∏–ø—Ç–æ–≤-–æ–±–µ—Ä—Ç–æ–∫ —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π |

---

## üîÑ –ü—Ä–æ—Ü–µ—Å—Å —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è

### –û–±—â–∞—è —Å—Ö–µ–º–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Jenkins    ‚îÇ  CI —ç—Ç–∞–ø (clearAgent)
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§  ‚îú‚îÄ –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–µ–∫—Ä–µ—Ç–æ–≤ –∏–∑ Vault
‚îÇ 1. Vault     ‚îÇ  ‚îú‚îÄ –°–æ–∑–¥–∞–Ω–∏–µ temp_data_cred.json
‚îÇ 2. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è ‚îÇ  ‚îî‚îÄ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ª–∞—É–Ω—á–µ—Ä–æ–≤ (SHA256)
‚îÇ    –ª–∞—É–Ω—á–µ—Ä–æ–≤ ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
        ‚îÇ SCP
        ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   –¶–µ–ª–µ–≤–æ–π    ‚îÇ  CDL —ç—Ç–∞–ø (masterLin)
‚îÇ   —Å–µ—Ä–≤–µ—Ä     ‚îÇ  ‚îú‚îÄ –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–∞ –∏ –æ–±–µ—Ä—Ç–æ–∫
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§  ‚îú‚îÄ –ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π sudo
‚îÇ 3. –û—á–∏—Å—Ç–∫–∞   ‚îÇ  ‚îÇ
‚îÇ 4. Vault     ‚îÇ  ‚îî‚îÄ –ó–∞–ø—É—Å–∫ install-monitoring-stack.sh
‚îÇ 5. RLM RPM   ‚îÇ      ‚îú‚îÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Vault Agent
‚îÇ 6. Cert      ‚îÇ      ‚îú‚îÄ –ó–∞–≥—Ä—É–∑–∫–∞ RPM —á–µ—Ä–µ–∑ RLM
‚îÇ 7. Config    ‚îÇ      ‚îú‚îÄ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤
‚îÇ 8. Services  ‚îÇ      ‚îú‚îÄ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–µ—Ä–≤–∏—Å–æ–≤
‚îÇ 9. Firewall  ‚îÇ      ‚îú‚îÄ –ó–∞–ø—É—Å–∫ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞
‚îÇ10. Grafana   ‚îÇ      ‚îî‚îÄ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Grafana datasource
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –í—Ä–µ–º–µ–Ω–Ω–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è                         ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ 0-2 –º–∏–Ω     ‚îÇ CI: –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–µ–∫—Ä–µ—Ç–æ–≤ –∏–∑ Vault             ‚îÇ
‚îÇ 2-3 –º–∏–Ω     ‚îÇ CDL: –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä (SCP)            ‚îÇ
‚îÇ 3-4 –º–∏–Ω     ‚îÇ –û—á–∏—Å—Ç–∫–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —É—Å—Ç–∞–Ω–æ–≤–æ–∫                ‚îÇ
‚îÇ 4-6 –º–∏–Ω     ‚îÇ RLM: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Vault Agent                  ‚îÇ
‚îÇ 6-11 –º–∏–Ω    ‚îÇ RLM: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ RPM (Grafana+Prometheus+H.)  ‚îÇ
‚îÇ 11-12 –º–∏–Ω   ‚îÇ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ (Vault/SberCA)       ‚îÇ
‚îÇ 12-13 –º–∏–Ω   ‚îÇ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–µ—Ä–≤–∏—Å–æ–≤ (yml/ini/hcl)         ‚îÇ
‚îÇ 13-14 –º–∏–Ω   ‚îÇ –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–æ–≤ (systemctl start)           ‚îÇ
‚îÇ 14-15 –º–∏–Ω   ‚îÇ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Grafana (datasource + dashboards) ‚îÇ
‚îÇ 15-16 –º–∏–Ω   ‚îÇ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ –æ—á–∏—Å—Ç–∫–∞                          ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
–ò—Ç–æ–≥–æ: ~15 –º–∏–Ω—É—Ç (–ø—Ä–∏ —É—Å–ª–æ–≤–∏–∏ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ RLM)
```

---

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Jenkins

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–∞–π–ø–ª–∞–π–Ω–∞

#### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä |
|----------|-----|----------|--------|
| `SERVER_ADDRESS` | String | FQDN –∏–ª–∏ IP —Ü–µ–ª–µ–≤–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞ | `tvlds-mvp001939.cloud.delta.sbrf.ru` |
| `SSH_CREDENTIALS_ID` | String | ID Jenkins Credentials (SSH key) | `jenkins-ssh-key` |
| `SEC_MAN_ADDR` | String | –ê–¥—Ä–µ—Å Vault (–±–µ–∑ https://) | `vault.sbrf.ru` |
| `NAMESPACE_CI` | String | Namespace –≤ Vault | `CI04523276_CI10742292` |
| `RLM_API_URL` | String | URL RLM API | `https://api.rlm.sbrf.ru` |

#### –ü—É—Ç–∏ –∫ —Å–µ–∫—Ä–µ—Ç–∞–º –≤ Vault (KV)

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –û–ø–∏—Å–∞–Ω–∏–µ | –ö–ª—é—á–∏ –≤ —Å–µ–∫—Ä–µ—Ç–µ |
|----------|----------|-----------------|
| `VAULT_AGENT_KV` | AppRole –¥–ª—è Vault Agent | `role_id`, `secret_id` |
| `RPM_URL_KV` | URL-—ã RPM –ø–∞–∫–µ—Ç–æ–≤ | `harvest`, `prometheus`, `grafana` |
| `NETAPP_SSH_KV` | SSH –¥–æ—Å—Ç—É–ø –∫ NetApp | `addr`, `user`, `pass` |
| `GRAFANA_WEB_KV` | –£—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ Grafana | `user`, `pass` |
| `SBERCA_CERT_KV` | –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç SberCA | `cert`, `key` |

#### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –¢–∏–ø | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|-----|--------------|----------|
| `GRAFANA_PORT` | String | `3000` | –ü–æ—Ä—Ç Grafana |
| `PROMETHEUS_PORT` | String | `9090` | –ü–æ—Ä—Ç Prometheus |
| `ADMIN_EMAIL` | String | - | Email –¥–ª—è —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ |
| `NETAPP_API_ADDR` | String | - | FQDN NetApp –∫–ª–∞—Å—Ç–µ—Ä–∞ |

#### –§–ª–∞–≥–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

| –§–ª–∞–≥ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----|----------|
| `SKIP_VAULT_INSTALL` | Boolean | –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å —É—Å—Ç–∞–Ω–æ–≤–∫—É Vault —á–µ—Ä–µ–∑ RLM |
| `SKIP_RPM_INSTALL` | Boolean | ‚ö†Ô∏è –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –ø–∞–∫–µ—Ç—ã |
| `SKIP_CI_CHECKS` | Boolean | ‚ö° –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å CI –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É |
| `SKIP_DEPLOYMENT` | Boolean | üö´ –¢–æ–ª—å–∫–æ CI –ø—Ä–æ–≤–µ—Ä–∫–∏ (–±–µ–∑ –¥–µ–ø–ª–æ—è) |

### –°—Ç–µ–π–¥–∂–∏ –ø–∞–π–ø–ª–∞–π–Ω–∞

#### CI –≠—Ç–∞–ø (clearAgent)

1. **–û—á–∏—Å—Ç–∫–∞ workspace** - —É–¥–∞–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
2. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤** - –≤–∞–ª–∏–¥–∞—Ü–∏—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
3. **–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–æ–¥–µ** - git log, –≤–µ—Ä—Å–∏—è –∫–æ–¥–∞
4. **–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Å–µ—Ç–∏** - nslookup, ping, nc
5. **–ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ Vault** - —Å–æ–∑–¥–∞–Ω–∏–µ temp_data_cred.json

#### CDL –≠—Ç–∞–ø (masterLin)

6. **–ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä** - SCP —Å–∫—Ä–∏–ø—Ç–∞ –∏ –æ–±–µ—Ä—Ç–æ–∫
7. **–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è** - –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π sudo
8. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤** - —Å—Ç–∞—Ç—É—Å—ã —Å–µ—Ä–≤–∏—Å–æ–≤, –ø–æ—Ä—Ç—ã
9. **–û—á–∏—Å—Ç–∫–∞** - —É–¥–∞–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
10. **–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–≤–µ–¥–µ–Ω–∏–π** - IP, FQDN, —Å—Å—ã–ª–∫–∏ –Ω–∞ UI

---

## üñ•Ô∏è –†–∞–±–æ—Ç–∞ —Å–∫—Ä–∏–ø—Ç–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

#### 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ (Preparation)

```bash
check_sudo()              # –ü—Ä–æ–≤–µ—Ä–∫–∞ root –ø—Ä–∞–≤
check_dependencies()      # –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Ç–∏–ª–∏—Ç (curl, jq, iptables...)
check_and_close_ports()   # –û—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ –ø–æ—Ä—Ç–æ–≤ 3000, 9090, 12990, 12991
detect_network_info()     # –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ SERVER_IP –∏ SERVER_DOMAIN
cleanup_all_previous()    # –û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å—Ç–∞—Ä—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤, –æ—á–∏—Å—Ç–∫–∞ –∫–æ–Ω—Ñ–∏–≥–æ–≤
```

#### 2. Vault –∏ —Å–µ–∫—Ä–µ—Ç—ã

```bash
install_vault_via_rlm()         # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —á–µ—Ä–µ–∑ RLM (–µ—Å–ª–∏ –Ω–µ SKIP)
setup_vault_config()            # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ agent.hcl, role_id, secret_id
load_config_from_json()         # –ß—Ç–µ–Ω–∏–µ temp_data_cred.json
copy_certs_to_dirs()            # –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ cert/key –ø–æ /etc/*/cert/
```

#### 3. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞–∫–µ—Ç–æ–≤

```bash
create_rlm_install_tasks()      # –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á RLM –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ RPM
# –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è:
# - Grafana (–ø–æ—Ä—Ç 3000)
# - Prometheus (–ø–æ—Ä—Ç 9090)
# - Harvest (–ø–æ–ª–µ—Ä—ã NetApp + Unix)
```

#### 4. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

```bash
configure_harvest()             # /opt/harvest/harvest.yml
configure_prometheus()          # /etc/prometheus/prometheus.yml + web-config.yml
configure_grafana_ini()         # /etc/grafana/grafana.ini (TLS + –ø–æ—Ä—Ç)
configure_iptables()            # Firewall —á–µ—Ä–µ–∑ iptables_launcher.sh
```

#### 5. –ó–∞–ø—É—Å–∫ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞

```bash
configure_services()            # systemctl enable/start (prometheus, grafana, harvest)
ensure_grafana_token()          # –°–æ–∑–¥–∞–Ω–∏–µ service account + —Ç–æ–∫–µ–Ω
configure_grafana_datasource()  # –î–æ–±–∞–≤–ª–µ–Ω–∏–µ Prometheus datasource –≤ Grafana
import_grafana_dashboards()     # –ò–º–ø–æ—Ä—Ç –¥–∞—à–±–æ—Ä–¥–æ–≤ Harvest
verify_installation()           # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–æ–≤, –ø–æ—Ä—Ç–æ–≤, HTTP
```

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ –æ–±–µ—Ä—Ç–∫–∏

| –û–±–µ—Ä—Ç–∫–∞ | –í—ã–∑–æ–≤–æ–≤ | –û–ø–µ—Ä–∞—Ü–∏–∏ |
|---------|---------|----------|
| `rlm-api-wrapper_launcher.sh` | 8 | –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á Vault/RPM/Groups, –æ–ø—Ä–æ—Å —Å—Ç–∞—Ç—É—Å–æ–≤ |
| `config-writer_launcher.sh` | 10 | –ó–∞–ø–∏—Å—å –∫–æ–Ω—Ñ–∏–≥–æ–≤ (agent.hcl, grafana.ini, prometheus.yml...) |
| `grafana-api-wrapper_launcher.sh` | 13 | Datasource create/update, service account, —Ç–æ–∫–µ–Ω—ã, HTTP checks |
| `firewall-manager_launcher.sh` | 1 | –ù–∞—Å—Ç—Ä–æ–π–∫–∞ firewall –ø—Ä–∞–≤–∏–ª |

### –°–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ—Å–ª–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è

#### –°–µ—Ä–≤–∏—Å—ã

```bash
systemctl status prometheus    # Active (running)
systemctl status grafana-server # Active (running)
systemctl status harvest       # Active (running)
```

#### –ü–æ—Ä—Ç—ã

```bash
ss -tln | grep ':3000 '   # Grafana HTTPS
ss -tln | grep ':9090 '   # Prometheus HTTPS
ss -tln | grep ':12990 '  # Harvest NetApp poller
ss -tln | grep ':12991 '  # Harvest Unix poller
```

#### –§–∞–π–ª—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

```
/opt/vault/conf/
  ‚îú‚îÄ‚îÄ agent.hcl              # Vault Agent config
  ‚îú‚îÄ‚îÄ role_id.txt            # AppRole ID
  ‚îú‚îÄ‚îÄ secret_id.txt          # AppRole Secret
  ‚îî‚îÄ‚îÄ data_sec.json          # –°–µ–∫—Ä–µ—Ç—ã –æ—Ç Vault (–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∞–≥–µ–Ω—Ç–æ–º)

/etc/prometheus/
  ‚îú‚îÄ‚îÄ prometheus.yml         # Scrape configs
  ‚îú‚îÄ‚îÄ web-config.yml         # mTLS config
  ‚îî‚îÄ‚îÄ cert/                  # server.crt, server.key, ca_chain.crt

/etc/grafana/
  ‚îú‚îÄ‚îÄ grafana.ini            # Grafana config (–ø–æ—Ä—Ç, TLS)
  ‚îî‚îÄ‚îÄ cert/                  # crt.crt, key.key

/opt/harvest/
  ‚îú‚îÄ‚îÄ harvest.yml            # Pollers config (NetApp + Unix)
  ‚îî‚îÄ‚îÄ cert/                  # harvest.crt, harvest.key

/var/lib/monitoring_deployment_state  # –°–æ—Å—Ç–æ—è–Ω–∏–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏
```

---

## üîê –°–∏—Å—Ç–µ–º–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### –ú–æ–¥–µ–ª—å —É–≥—Ä–æ–∑ –∏ –∑–∞—â–∏—Ç–∞

#### 1. –ò–Ω—ä–µ–∫—Ü–∏—è –∫–æ–º–∞–Ω–¥

**–£–≥—Ä–æ–∑–∞:** –ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –ø—ã—Ç–∞–µ—Ç—Å—è –≤—ã–ø–æ–ª–Ω–∏—Ç—å –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã —á–µ—Ä–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

**–ó–∞—â–∏—Ç–∞:**
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –≤—Ö–æ–¥–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ regex'–∞–º–∏
- ‚úÖ –ë–µ–ª—ã–µ —Å–ø–∏—Å–∫–∏ –¥–ª—è URL, –ø–æ—Ä—Ç–æ–≤, IP, –ø—É—Ç–µ–π
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `jq` –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ JSON (–Ω–µ `eval`)
- ‚úÖ –≠–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤

```bash
# –ü—Ä–∏–º–µ—Ä –∏–∑ firewall-manager.sh:
validate_port() {
  local port="$1"
  [[ "$port" =~ ^[0-9]+$ ]] || fail "–ù–µ–¥–æ–ø—É—Å—Ç–∏–º—ã–π –ø–æ—Ä—Ç"
  (( port < 1 || port > 65535 )) && fail "–ü–æ—Ä—Ç –≤–Ω–µ –¥–∏–∞–ø–∞–∑–æ–Ω–∞"
}
```

#### 2. –ü–æ–¥–º–µ–Ω–∞ –∫–æ–¥–∞ –æ–±–µ—Ä—Ç–æ–∫

**–£–≥—Ä–æ–∑–∞:** –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–æ–≤-–æ–±–µ—Ä—Ç–æ–∫ –¥–ª—è –æ–±—Ö–æ–¥–∞ –∑–∞—â–∏—Ç—ã

**–ó–∞—â–∏—Ç–∞:**
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ SHA256 –ø–µ—Ä–µ–¥ –∫–∞–∂–¥—ã–º –∑–∞–ø—É—Å–∫–æ–º
- ‚úÖ –õ–∞—É–Ω—á–µ—Ä—ã –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤ Jenkins
- ‚úÖ –ü—Ä–∏ –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Ö–µ—à–∞ - –Ω–µ–º–µ–¥–ª–µ–Ω–Ω—ã–π –æ—Ç–∫–∞–∑

```bash
# –ü—Ä–∏–º–µ—Ä –∏–∑ iptables_launcher.sh:
EXPECTED_HASH="a1b2c3d4e5f6..."
calc_hash=$(sha256sum "$WRAPPER" | awk '{print $1}')
if [[ "$calc_hash" != "$EXPECTED_HASH" ]]; then
  echo "[SECURITY] Hash mismatch" >&2
  exit 1
fi
```

#### 3. –£—Ç–µ—á–∫–∞ —Å–µ–∫—Ä–µ—Ç–æ–≤

**–£–≥—Ä–æ–∑–∞:** –°–µ–∫—Ä–µ—Ç—ã –ø–æ–ø–∞–¥–∞—é—Ç –≤ –ª–æ–≥–∏, –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è, —Ñ–∞–π–ª–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É

**–ó–∞—â–∏—Ç–∞:**
- ‚úÖ –°–µ–∫—Ä–µ—Ç—ã —Ö—Ä–∞–Ω—è—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ Vault
- ‚úÖ –ü–µ—Ä–µ–¥–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (–Ω–µ —Ñ–∞–π–ª—ã)
- ‚úÖ –û—á–∏—â–∞—é—Ç—Å—è –ø–æ—Å–ª–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è (`unset`)
- ‚úÖ –ù–µ –≤—ã–≤–æ–¥—è—Ç—Å—è –≤ –ª–æ–≥–∏ (–ø—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö `echo`/`print_info`)

```bash
# –ü—Ä–∏–º–µ—Ä –∏–∑ install-monitoring-stack.sh:
GRAFANA_BEARER_TOKEN="$bearer_token"
export GRAFANA_BEARER_TOKEN
# ... –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ ...
unset GRAFANA_BEARER_TOKEN RLM_TOKEN GRAFANA_PASSWORD
```

#### 4. –ü–æ–≤—ã—à–µ–Ω–∏–µ –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π

**–£–≥—Ä–æ–∑–∞:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ sudo –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã—Ö –∫–æ–º–∞–Ω–¥

**–ó–∞—â–∏—Ç–∞:**
- ‚úÖ –¢–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–π sudo (–Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Å–∫—Ä–∏–ø—Ç)
- ‚úÖ `NOEXEC` –∑–∞–ø—Ä–µ—â–∞–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–æ—á–µ—Ä–Ω–∏—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
- ‚úÖ –ù–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è `*` –≤ sudoers
- ‚úÖ –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø—É—Ç–∏ (–±–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö)

```
# sudoers:
CI-user ALL=(ALL:ALL) NOEXEC: NOPASSWD: /bin/bash /tmp/deploy-monitoring/install-monitoring-stack.sh
```

#### 5. SSRF / –ù–µ—Å–∞–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã

**–£–≥—Ä–æ–∑–∞:** –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ HTTP-–∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–º –∞–¥—Ä–µ—Å–∞–º

**–ó–∞—â–∏—Ç–∞:**
- ‚úÖ –ë–µ–ª—ã–π —Å–ø–∏—Å–æ–∫ URL –¥–ª—è RLM: `https://api.rlm.sbrf.ru`
- ‚úÖ Grafana API: —Ç–æ–ª—å–∫–æ `https://<host>:3000`
- ‚úÖ HTTP checks: —Ç–æ–ª—å–∫–æ `http(s)://127.0.0.1:<port>`
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º–∞—Ç–∞ URL regex'–∞–º–∏

```bash
# –ü—Ä–∏–º–µ—Ä –∏–∑ rlm-api-wrapper.sh:
ALLOWED_RLM_BASES=("https://api.rlm.sbrf.ru")
validate_url_base() {
  local url="$1"
  [[ "$url" =~ ^https://[a-zA-Z0-9._:-]+(/.*)?$ ]] || fail "–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç"
  # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ whitelist...
}
```

### –ê—É–¥–∏—Ç –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

#### –£—Ä–æ–≤–Ω–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

```bash
[INFO]    # –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
[SUCCESS] # ‚úÖ –£—Å–ø–µ—à–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
[WARNING] # ‚ö†Ô∏è  –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è (–Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ)
[ERROR]   # ‚ùå –û—à–∏–±–∫–∏ (–∫—Ä–∏—Ç–∏—á–Ω–æ, –≤–æ–∑–º–æ–∂–Ω–∞ –æ—Å—Ç–∞–Ω–æ–≤–∫–∞)
[STEP]    # üìã –ù–∞—á–∞–ª–æ –Ω–æ–≤–æ–π —Å—Ç–∞–¥–∏–∏
```

#### –î–µ—Ç–∞–ª—å–Ω–æ—Å—Ç—å –ª–æ–≥–æ–≤

```bash
[2026-01-23 10:30:15] [STEP] –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Prometheus —á–µ—Ä–µ–∑ RLM
[2026-01-23 10:30:16] [RLM_WRAPPER] –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏: service=LINUX_RPM_INSTALLER
[2026-01-23 10:30:17] [RLM_WRAPPER] Payload: {"service":"LINUX_RPM_INSTALLER",...}
[2026-01-23 10:30:18] [RLM_WRAPPER] Response HTTP 200
[2026-01-23 10:30:18] [SUCCESS] ‚úÖ –ó–∞–¥–∞—á–∞ —Å–æ–∑–¥–∞–Ω–∞. ID: 12345
[2026-01-23 10:30:19] [INFO] –û–∂–∏–¥–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ (–ø–æ–ø—ã—Ç–∫–∞ 1/120)...
[2026-01-23 10:33:45] [SUCCESS] ‚úÖ –ó–∞–¥–∞—á–∞ 12345 –∑–∞–≤–µ—Ä—à–µ–Ω–∞ (status=success)
```

### Compliance –∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç—ã

- ‚úÖ **–°–¢–û –ë–† –ò–ë–ë–°-1.2-2023** - –°—Ç–∞–Ω–¥–∞—Ä—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –°–±–µ—Ä–±–∞–Ω–∫–∞
- ‚úÖ **–ì–û–°–¢ –† 57580** - –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π
- ‚úÖ **PCI DSS** - –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –æ–±—Ä–∞–±–æ—Ç–∫–µ —Å–µ–∫—Ä–µ—Ç–æ–≤
- ‚úÖ **ISO 27001** - –°–∏—Å—Ç–µ–º–∞ –º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

> üìñ **–ü–æ–ª–Ω—ã–π –∞—É–¥–∏—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:** [`SECURITY.md`](SECURITY.md)

---

## üìä –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –î–æ—Å—Ç—É–ø –∫ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞–º

```bash
# Grafana UI
https://<SERVER_ADDRESS>:3000
–õ–æ–≥–∏–Ω: admin (–∏–∑ GRAFANA_WEB_KV)
–ü–∞—Ä–æ–ª—å: (–∏–∑ Vault)

# Prometheus UI
https://<SERVER_ADDRESS>:9090
# mTLS: —Ç—Ä–µ–±—É–µ—Ç—Å—è –∫–ª–∏–µ–Ω—Ç—Å–∫–∏–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç

# Harvest –º–µ—Ç—Ä–∏–∫–∏
https://<SERVER_ADDRESS>:12990/metrics  # NetApp poller
https://<SERVER_ADDRESS>:12991/metrics  # Unix poller
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è

```bash
# –°—Ç–∞—Ç—É—Å—ã —Å–µ—Ä–≤–∏—Å–æ–≤
systemctl status prometheus grafana-server harvest

# –õ–æ–≥–∏ —Å–µ—Ä–≤–∏—Å–æ–≤
journalctl -u prometheus -n 50 --no-pager
journalctl -u grafana-server -n 50 --no-pager
journalctl -u harvest -n 50 --no-pager

# Vault Agent
journalctl -u vault-agent -n 50 --no-pager
cat /opt/vault/log/agent.log | tail -50

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ä—Ç–æ–≤
ss -tlnp | grep -E ':(3000|9090|12990|12991)'

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤
openssl x509 -in /etc/prometheus/cert/server.crt -noout -text
openssl x509 -in /etc/grafana/cert/crt.crt -noout -dates
```

### –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–æ–≤

```bash
# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
sudo systemctl restart prometheus
sudo systemctl restart grafana-server
sudo systemctl restart harvest

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –≤—Å–µ–≥–æ —Å—Ç–µ–∫–∞
sudo systemctl restart prometheus grafana-server harvest

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞
sudo systemctl status prometheus grafana-server harvest
```

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

```bash
# 1. –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥–æ–≤
sudo vim /etc/prometheus/prometheus.yml
sudo vim /etc/grafana/grafana.ini
sudo vim /opt/harvest/harvest.yml

# 2. –í–∞–ª–∏–¥–∞—Ü–∏—è (–¥–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞)
promtool check config /etc/prometheus/prometheus.yml
grafana-cli admin reset-admin-password --config /etc/grafana/grafana.ini newpassword

# 3. –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π
sudo systemctl restart prometheus
sudo systemctl restart grafana-server
sudo systemctl restart harvest

# 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤
journalctl -u prometheus -f
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –º–µ—Ç—Ä–∏–∫

```bash
# –ß–µ—Ä–µ–∑ Prometheus
# Targets: http://<SERVER_ADDRESS>:9090/targets
# - prometheus (self)
# - harvest-unix (localhost:12991)
# - harvest-netapp (SERVER_DOMAIN:12990)

# –í–∞–∂–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏:
# - up{job="prometheus"} - –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å Prometheus
# - up{job="harvest-unix"} - –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å Unix poller
# - up{job="harvest-netapp-https"} - –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å NetApp poller
# - netapp_volume_* - –º–µ—Ç—Ä–∏–∫–∏ NetApp volumes
# - node_* - –º–µ—Ç—Ä–∏–∫–∏ Unix —Å–∏—Å—Ç–µ–º—ã
```

---

## üîß –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∏ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

#### 1. Jenkins –Ω–µ –º–æ–∂–µ—Ç –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É

**–°–∏–º–ø—Ç–æ–º—ã:**
```
[ERROR] SSH –∫–ª—é—á –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
Stage 'CDL: –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä' skipped
```

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ SSH —Å Jenkins-–∞–≥–µ–Ω—Ç–∞
ssh -i /path/to/key CI-user@SERVER_ADDRESS "echo 'OK'"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –Ω–∞ –∫–ª—é—á
chmod 600 /path/to/key

# –ü—Ä–æ–≤–µ—Ä–∫–∞ known_hosts
ssh-keyscan SERVER_ADDRESS >> ~/.ssh/known_hosts
```

#### 2. Vault –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–µ–∫—Ä–µ—Ç—ã

**–°–∏–º–ø—Ç–æ–º—ã:**
```
[ERROR] –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ Vault
temp_data_cred.json –ø—É—Å—Ç–æ–π
```

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ Vault
vault login -method=approle role_id=xxx secret_id=yyy

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è —Å–µ–∫—Ä–µ—Ç–æ–≤
vault kv get secret/${NAMESPACE_CI}/vault-agent
vault kv get secret/${NAMESPACE_CI}/rpm_url

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ Jenkins credentials
# Jenkins ‚Üí Manage Jenkins ‚Üí Credentials ‚Üí –ø—Ä–æ–≤–µ—Ä–∏—Ç—å vault-agent-dev
```

#### 3. RLM –∑–∞–¥–∞—á–∏ –Ω–µ —Å–æ–∑–¥–∞—é—Ç—Å—è

**–°–∏–º–ø—Ç–æ–º—ã:**
```
[RLM_WRAPPER][ERROR] HTTP 401 Unauthorized
–ó–∞–¥–∞—á–∞ Vault: —Å–æ–∑–¥–∞–Ω–∏–µ –Ω–µ —É–¥–∞–ª–æ—Å—å
```

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–∞ RLM
curl -H "Authorization: Token $RLM_TOKEN" \
     https://api.rlm.sbrf.ru/api/tasks.json

# –ü—Ä–æ–≤–µ—Ä–∫–∞ whitelist URL
# –í rlm-api-wrapper.sh: ALLOWED_RLM_BASES=(...)

# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞ –≤ Jenkins
# Jenkins ‚Üí Credentials ‚Üí rlm-token ‚Üí Update Secret
```

#### 4. Prometheus –Ω–µ —Å—Ç–∞—Ä—Ç—É–µ—Ç

**–°–∏–º–ø—Ç–æ–º—ã:**
```
[ERROR] Prometheus: –Ω–µ —É–¥–∞–ª–æ—Å—å –∑–∞–ø—É—Å—Ç–∏—Ç—å
systemctl status prometheus ‚Üí failed
```

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
promtool check config /etc/prometheus/prometheus.yml

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –Ω–∞ —Ñ–∞–π–ª—ã
ls -la /etc/prometheus/cert/
ls -la /var/lib/prometheus/data/

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ä—Ç–æ–≤
ss -tln | grep :9090

# –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
sudo -u prometheus /usr/bin/prometheus \
  --config.file=/etc/prometheus/prometheus.yml \
  --web.listen-address=0.0.0.0:9090

# –õ–æ–≥–∏
journalctl -u prometheus -n 100 --no-pager
```

#### 5. Grafana –Ω–µ —Å–æ–∑–¥–∞–µ—Ç datasource

**–°–∏–º–ø—Ç–æ–º—ã:**
```
[WARNING] –ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å datasource —á–µ—Ä–µ–∑ API
HTTP 400 Bad Request
```

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ API Grafana
curl -k -u admin:admin https://localhost:3000/api/datasources

# –†—É—á–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ datasource —á–µ—Ä–µ–∑ UI
# Grafana ‚Üí Configuration ‚Üí Data Sources ‚Üí Add Prometheus

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–∞
# –¢–æ–∫–µ–Ω –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π GRAFANA_BEARER_TOKEN

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ –¥–ª—è mTLS
ls -la /opt/vault/certs/grafana-client.{crt,key}
ls -la /etc/prometheus/cert/ca_chain.crt
```

#### 6. Harvest –Ω–µ —Å–æ–±–∏—Ä–∞–µ—Ç –º–µ—Ç—Ä–∏–∫–∏

**–°–∏–º–ø—Ç–æ–º—ã:**
```
[ERROR] Harvest: –Ω–µ—Ç –º–µ—Ç—Ä–∏–∫ –Ω–∞ –ø–æ—Ä—Ç—É 12990
curl https://localhost:12990/metrics ‚Üí connection refused
```

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
cat /opt/harvest/harvest.yml

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤
journalctl -u harvest -n 100 --no-pager

# –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫
cd /opt/harvest
./bin/harvest start --config harvest.yml --foreground

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ NetApp
curl -k -u user:pass https://<NETAPP_API_ADDR>/api/cluster

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤
openssl s_client -connect <NETAPP_API_ADDR>:443 \
  -cert /opt/harvest/cert/harvest.crt \
  -key /opt/harvest/cert/harvest.key
```

### –õ–æ–≥–∏ –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

```bash
# –í—Å–µ –ª–æ–≥–∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
journalctl -u prometheus -u grafana-server -u harvest -u vault-agent --since "1 hour ago"

# Jenkins –ª–æ–≥–∏
# Jenkins UI ‚Üí Build History ‚Üí [–Ω–æ–º–µ—Ä –±–∏–ª–¥–∞] ‚Üí Console Output

# –í—Ä–µ–º–µ–Ω–Ω—ã–µ –ª–æ–≥–∏ —Å–∫—Ä–∏–ø—Ç–∞ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è
cat ~/monitoring_deployment_*.log

# –î–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–µ –ª–æ–≥–∏ Grafana (–µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω—ã)
cat /tmp/grafana-debug.log

# –°–æ—Å—Ç–æ—è–Ω–∏–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏
cat /var/lib/monitoring_deployment_state
```

### –ü–æ–ª–Ω–∞—è –ø–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
# 1. –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
sudo systemctl stop prometheus grafana-server harvest vault-agent

# 2. –û—á–∏—Å—Ç–∫–∞
sudo rm -rf /etc/prometheus /etc/grafana /opt/harvest
sudo rm -rf /var/lib/prometheus /var/lib/grafana
sudo rm -rf /opt/vault/conf/* /opt/vault/certs/*

# 3. –ó–∞–ø—É—Å–∫ –ø–∞–π–ø–ª–∞–π–Ω–∞ –∑–∞–Ω–æ–≤–æ
# Jenkins ‚Üí Build with Parameters ‚Üí Build
```

---

## ‚ùì FAQ

### –û–±—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã

**Q: –ú–æ–∂–Ω–æ –ª–∏ –∑–∞–ø—É—Å–∫–∞—Ç—å —Å–∫—Ä–∏–ø—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑?**  
A: –î–∞, —Å–∫—Ä–∏–ø—Ç –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–µ–Ω. –ü—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º –∑–∞–ø—É—Å–∫–µ:
- –°—Ç–∞—Ä—ã–µ —Å–µ—Ä–≤–∏—Å—ã –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è
- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è
- –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è

**Q: –ö–∞–∫–∏–µ –¥–∞–Ω–Ω—ã–µ —É–¥–∞–ª—è—é—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∫–µ?**  
A: –£–¥–∞–ª—è—é—Ç—Å—è:
- –ú–µ—Ç—Ä–∏–∫–∏ Prometheus (`/var/lib/prometheus`)
- –ë–∞–∑–∞ Grafana (`/var/lib/grafana/grafana.db`)
- –î–∞—à–±–æ—Ä–¥—ã Grafana

–î–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `SKIP_GRAFANA_DATA_CLEANUP=true`

**Q: –ú–æ–∂–Ω–æ –ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–µ–∑ Jenkins?**  
A: –î–∞, –º–æ–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å –≤—Ä—É—á–Ω—É—é:
```bash
# 1. –°–æ–∑–¥–∞–π—Ç–µ temp_data_cred.json —Å —Å–µ–∫—Ä–µ—Ç–∞–º–∏
# 2. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å–∫—Ä–∏–ø—Ç –∏ wrappers –Ω–∞ —Å–µ—Ä–≤–µ—Ä
# 3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ:
sudo -n env \
  SEC_MAN_ADDR="vault.sbrf.ru" \
  NAMESPACE_CI="CI_xxx" \
  RLM_TOKEN="xxx" \
  ... \
  /bin/bash install-monitoring-stack.sh
```

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

**Q: –ì–¥–µ —Ö—Ä–∞–Ω—è—Ç—Å—è —Å–µ–∫—Ä–µ—Ç—ã?**  
A: 
- **Vault** ‚Äì –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ
- **temp_data_cred.json** ‚Äì –≤—Ä–µ–º–µ–Ω–Ω–æ (—É–¥–∞–ª—è–µ—Ç—Å—è –ø–æ—Å–ª–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è)
- **–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è** ‚Äì —Ç–æ–ª—å–∫–æ –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (–æ—á–∏—â–∞—é—Ç—Å—è –ø–æ—Å–ª–µ)

**Q: –ú–æ–∂–Ω–æ –ª–∏ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ç–æ–∫–µ–Ω RLM?**  
A: –ù–µ—Ç, —Ç–æ–∫–µ–Ω:
- –•—Ä–∞–Ω–∏—Ç—Å—è –≤ Jenkins Credentials (encrypted)
- –ü–µ—Ä–µ–¥–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è
- –ù–µ –≤—ã–≤–æ–¥–∏—Ç—Å—è –≤ –ª–æ–≥–∏
- –û—á–∏—â–∞–µ—Ç—Å—è –∫–æ–º–∞–Ω–¥–æ–π `unset`

**Q: –ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–ª—É–∂–±–∞ –ò–ë?**  
A:
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ `*` –∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤ sudoers
- SHA256 —Ö–µ—à–∏ –≤—Å–µ—Ö –æ–±–µ—Ä—Ç–æ–∫
- –ë–µ–ª—ã–µ —Å–ø–∏—Å–∫–∏ (URL, –ø–æ—Ä—Ç—ã, –ø—É—Ç–∏)
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Å–µ–∫—Ä–µ—Ç–æ–≤ –≤ –ª–æ–≥–∞—Ö

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

**Q: –°–∫–æ–ª—å–∫–æ –≤—Ä–µ–º–µ–Ω–∏ –∑–∞–Ω–∏–º–∞–µ—Ç —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ?**  
A: 
- –¢–∏–ø–∏—á–Ω–æ: **12-15 –º–∏–Ω—É—Ç**
- –° SKIP_VAULT_INSTALL: **8-10 –º–∏–Ω—É—Ç**
- –° SKIP_RPM_INSTALL: **3-5 –º–∏–Ω—É—Ç**

**Q: –ú–æ–∂–Ω–æ –ª–∏ —É—Å–∫–æ—Ä–∏—Ç—å RLM –∑–∞–¥–∞—á–∏?**  
A: –ù–µ—Ç, –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–≤–∏—Å–∏—Ç –æ—Ç RLM. –ú–æ–∂–Ω–æ —Ç–æ–ª—å–∫–æ:
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `SKIP_VAULT_INSTALL` –µ—Å–ª–∏ Vault —É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `SKIP_RPM_INSTALL` –µ—Å–ª–∏ –ø–∞–∫–µ—Ç—ã —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã

**Q: –°–∫–æ–ª—å–∫–æ —Ä–µ—Å—É—Ä—Å–æ–≤ –ø–æ—Ç—Ä–µ–±–ª—è–µ—Ç —Å—Ç–µ–∫?**  
A:
- **CPU**: 1-2 —è–¥—Ä–∞ (Prometheus + Grafana + Harvest)
- **RAM**: 2-4 GB
- **–î–∏—Å–∫**: 10-20 GB (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç retention Prometheus)

### Troubleshooting

**Q: –ö–∞–∫ –≤–∫–ª—é—á–∏—Ç—å debug —Ä–µ–∂–∏–º?**  
A: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –≤ –Ω–∞—á–∞–ª–µ —Å–∫—Ä–∏–ø—Ç–∞:
```bash
set -x  # –í—ã–≤–æ–¥ –≤—Å–µ—Ö –∫–æ–º–∞–Ω–¥
export DEBUG=1  # Debug mode
```

**Q: –ì–¥–µ –∏—Å–∫–∞—Ç—å –ø—Ä–∏—á–∏–Ω—É –æ—à–∏–±–∫–∏?**  
A: –ü–æ—Ä—è–¥–æ–∫ –ø—Ä–æ–≤–µ—Ä–∫–∏:
1. Jenkins Console Output (–ø–æ–ª–Ω—ã–π –ª–æ–≥ –ø–∞–π–ø–ª–∞–π–Ω–∞)
2. `journalctl -u prometheus/grafana/harvest`
3. `/tmp/grafana-debug.log`
4. `/opt/vault/log/agent.log`
5. `~/monitoring_deployment_*.log`

**Q: –°–∫—Ä–∏–ø—Ç –∑–∞–≤–µ—Ä—à–∏–ª—Å—è —Å –æ—à–∏–±–∫–æ–π, —á—Ç–æ –¥–µ–ª–∞—Ç—å?**  
A:
1. –ù–∞–π—Ç–∏ –ø–æ—Å–ª–µ–¥–Ω–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ `[ERROR]` –≤ –ª–æ–≥–∞—Ö
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é —Å–µ–∫—Ü–∏—é (Vault/RLM/Config)
3. –£—Å—Ç—Ä–∞–Ω–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—É (–¥–æ—Å—Ç—É–ø –∫ Vault, —Ç–æ–∫–µ–Ω RLM, –ø–æ—Ä—Ç—ã)
4. –ó–∞–ø—É—Å—Ç–∏—Ç—å –∑–∞–Ω–æ–≤–æ (—Å–∫—Ä–∏–ø—Ç –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–µ–Ω)

---

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞

- üì¶ [PROJECT_INFO.md](PROJECT_INFO.md) - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–æ–µ–∫—Ç–µ –∏ –µ–≥–æ –Ω–∞–∑–≤–∞–Ω–∏–∏
- üìù [CHANGELOG.md](CHANGELOG.md) - –ü–æ–ª–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ (–æ–∫—Ç 2025 - —è–Ω–≤ 2026)
- üìñ [SECURITY.md](SECURITY.md) - –î–µ—Ç–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- üìù [RENAME_GUIDE.md](RENAME_GUIDE.md) - –ò—Å—Ç–æ—Ä–∏—è –∏ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏—è–º
- ‚öôÔ∏è [sudoers.template](sudoers.template) - –†–∞–∑–≤–µ—Ä–Ω—É—Ç—ã–π —à–∞–±–ª–æ–Ω sudoers —Å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
- üìú [sudoers.example](sudoers.example) - –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–±–æ—á–∏–π sudoers

### –í–Ω–µ—à–Ω–∏–µ —Ä–µ—Å—É—Ä—Å—ã

- üîê [HashiCorp Vault Documentation](https://www.vaultproject.io/docs)
- üìä [Prometheus Documentation](https://prometheus.io/docs/)
- üìà [Grafana Documentation](https://grafana.com/docs/)
- üåæ [NetApp Harvest Documentation](https://github.com/NetApp/harvest)
- üîÑ [Jenkins Pipeline Syntax](https://www.jenkins.io/doc/book/pipeline/syntax/)

### –ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- üè¢ RLM API: `https://api.rlm.sbrf.ru/docs`
- üîí SberCA: `https://sberca.sberbank.ru`
- üìö Confluence: –≤–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥—É

---

## üë• –ü–æ–¥–¥–µ—Ä–∂–∫–∞

### –î–ª—è –≤–æ–ø—Ä–æ—Å–æ–≤ –ø–æ:

- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –∞—É–¥–∏—Ç—É** ‚Üí –°–ª—É–∂–±–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- **Jenkins –∏ CI/CD** ‚Üí DevOps –∫–æ–º–∞–Ω–¥–∞
- **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥—É (Prometheus/Grafana)** ‚Üí –ö–æ–º–∞–Ω–¥–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
- **NetApp –∏ Harvest** ‚Üí –ö–æ–º–∞–Ω–¥–∞ —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
- **Vault** ‚Üí –ö–æ–º–∞–Ω–¥–∞ —Å–µ–∫—Ä–µ—Ç–æ–≤ –∏ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã

### –ö–æ–Ω—Ç—Ä–∏–±—å—é—Ü–∏—è

–î–ª—è –≤–Ω–µ—Å–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π:
1. –°–æ–∑–¥–∞–π—Ç–µ feature branch
2. –í–Ω–µ—Å–∏—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å –ø–æ–Ω—è—Ç–Ω—ã–º–∏ commit messages
3. –û–±–Ω–æ–≤–∏—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é (README.md, SECURITY.md)
4. –°–æ–∑–¥–∞–π—Ç–µ Pull Request
5. –î–æ–∂–¥–∏—Ç–µ—Å—å —Ä–µ–≤—å—é –æ—Ç:
   - DevOps (—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å)
   - –ò–ë (–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å)
   - –°–∏—Å—Ç–µ–º–Ω—ã–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã (–æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞)

---

## üìù Changelog

### Version 3.0.0 (2026-01-23) - üé® Professional Naming & Final Polish

**Breaking Changes:**
- üîÑ –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤ –Ω–∞ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å (kebab-case)
- üì¶ –ü—Ä–æ–µ–∫—Ç –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω: `new_deploy_sh_1` ‚Üí `monitoring-stack-automation`
- üóÇÔ∏è Wrappers –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω—ã —Å –æ–ø–∏—Å–∞—Ç–µ–ª—å–Ω—ã–º–∏ –∏–º–µ–Ω–∞–º–∏

**Features:**
- ‚ú® –°–æ–∑–¥–∞–Ω PROJECT_INFO.md —Å –º–µ—Ç–∞-–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –ø—Ä–æ–µ–∫—Ç–∞
- üìñ –ü–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∞–Ω README.md (1096 —Å—Ç—Ä–æ–∫, 44 KB)
- üìù –î–æ–±–∞–≤–ª–µ–Ω RENAME_GUIDE.md —Å —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ–º –ø–æ –º–∏–≥—Ä–∞—Ü–∏–∏
- üé® ASCII-–ª–æ–≥–æ—Ç–∏–ø –∏ –±—Ä–µ–Ω–¥–∏–Ω–≥ –ø—Ä–æ–µ–∫—Ç–∞
- üè∑Ô∏è Badges –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ (version, status, security)

**Improvements:**
- üßπ –£–¥–∞–ª–µ–Ω –º–µ—Ä—Ç–≤—ã–π –∫–æ–¥ (55 —Å—Ç—Ä–æ–∫ –∏–∑ deploy script –∏ Jenkinsfile)
- üìö –£–ª—É—á—à–µ–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ (4 MD —Ñ–∞–π–ª–∞)
- üîó –í—Å–µ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ —Å—Å—ã–ª–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã
- ‚ö° –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è fallback –ª–æ–≥–∏–∫–∏ –≤ Grafana API

**Files Renamed:**
- `deploy_monitoring_script.sh` ‚Üí `install-monitoring-stack.sh`
- `SECURITY_IB_NOTES.md` ‚Üí `SECURITY.md`
- `wrappers/*_wrapper.sh` ‚Üí `wrappers/*-api-wrapper.sh`
- `generate_launchers.sh` ‚Üí `build-integrity-checkers.sh`

---

### Version 2.8.0 (2026-01-20) - üîß Bug Fixes & Stability

**Bug Fixes:**
- üêõ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞ —Å Grafana service account creation (HTTP 400)
- üîß –£–ª—É—á—à–µ–Ω –ø–∞—Ä—Å–∏–Ω–≥ JSON –æ—Ç–≤–µ—Ç–æ–≤ –æ—Ç Grafana API
- üõ†Ô∏è –ò—Å–ø—Ä–∞–≤–ª–µ–Ω fallback –º–µ—Ö–∞–Ω–∏–∑–º –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ localhost
- üìä –£–ª—É—á—à–µ–Ω–∞ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –æ—à–∏–±–æ–∫ —Å –¥–µ—Ç–∞–ª—å–Ω—ã–º –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º

**Improvements:**
- üìà –î–æ–±–∞–≤–ª–µ–Ω–∞ –¥–µ—Ç–∞–ª—å–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –≤ DEBUG_LOG —Ñ–∞–π–ª—ã
- ‚ö° –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∫–æ–º–ø–∞–∫—Ç–Ω–æ–≥–æ JSON payload (jq -c)
- üîç –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–æ–≤ API

---

### Version 2.7.0 (2026-01-15) - üîí Enhanced Security & Monitoring

**Security:**
- üîê –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω –ø–æ–ª–Ω—ã–π mTLS –¥–ª—è –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- üõ°Ô∏è –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤
- üîë –£–ª—É—á—à–µ–Ω–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ–∫—Ä–µ—Ç–∞–º–∏ —á–µ—Ä–µ–∑ Vault
- üö´ –ó–∞–ø—Ä–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –¥–æ—á–µ—Ä–Ω–∏—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ (NOEXEC –≤ sudoers)

**Features:**
- üìä –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Harvest –¥–ª—è —Å–±–æ—Ä–∞ –º–µ—Ç—Ä–∏–∫ NetApp
- üéØ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∏–º–ø–æ—Ä—Ç –¥–∞—à–±–æ—Ä–¥–æ–≤ Harvest –≤ Grafana
- üåê –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ Unix —Å–∏—Å—Ç–µ–º —á–µ—Ä–µ–∑ Harvest
- üìà –ù–∞—Å—Ç—Ä–æ–π–∫–∞ job'–æ–≤ Prometheus –¥–ª—è scraping –º–µ—Ç—Ä–∏–∫

---

### Version 2.6.0 (2026-01-08) - üë• User Units & KAE Model

**Features:**
- üë• –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –º–æ–¥–µ–ª—å KAE –¥–ª—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö —É—á–µ—Ç–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π
- üîÑ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ systemd user-units –¥–ª—è `${KAE}-lnx-mon_sys`
- üîê –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ –≥—Ä—É–ø–ø—É `as-admin`
- üè† –í–∫–ª—é—á–µ–Ω–∏–µ linger –¥–ª—è user-—é–Ω–∏—Ç–æ–≤ —á–µ—Ä–µ–∑ RLM

**Technical:**
- üõ†Ô∏è `ensure_monitoring_users_in_as_admin()`
- üîß `adjust_prometheus_permissions_for_mon_sys()`
- üéØ `adjust_grafana_permissions_for_mon_sys()`

---

### Version 2.5.0 (2025-12-20) - üîê SHA256 Integrity Checks

**Security:**
- üîí SHA256 –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–ª—è –≤—Å–µ—Ö wrapper —Å–∫—Ä–∏–ø—Ç–æ–≤
- üöÄ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è launcher'–æ–≤ —Å embedded —Ö–µ—à–∞–º–∏
- üõ°Ô∏è –ó–∞—â–∏—Ç–∞ –æ—Ç –ø–æ–¥–º–µ–Ω—ã –∫–æ–¥–∞ –≤ –æ–±–µ—Ä—Ç–∫–∞—Ö
- ‚ö†Ô∏è –ù–µ–º–µ–¥–ª–µ–Ω–Ω—ã–π –æ—Ç–∫–∞–∑ –ø—Ä–∏ –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Ö–µ—à–∞

**Features:**
- üìù –°–∫—Ä–∏–ø—Ç `generate_launchers.sh` –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏
- üîÑ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ launcher'–æ–≤ –≤ Jenkins pipeline
- üìä –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏

---

### Version 2.4.0 (2025-12-10) - üåê Network & Certificate Management

**Features:**
- üîê –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ –∏–∑ Vault
- üìú –ü–æ–¥–¥–µ—Ä–∂–∫–∞ SberCA —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤
- üîë –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ cert/key –ø–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º (Prometheus, Grafana, Harvest)
- üåê –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ SERVER_IP –∏ SERVER_DOMAIN

---

### Version 2.3.0 (2025-12-01) - üîÑ RLM Integration

**Features:**
- üéØ –ü–æ–ª–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å RLM API
- üì¶ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ RPM —á–µ—Ä–µ–∑ RLM –∑–∞–¥–∞—á–∏
- üîê –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Vault Agent —á–µ—Ä–µ–∑ RLM
- üë• –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≥—Ä—É–ø–ø–∞–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —á–µ—Ä–µ–∑ RLM

**Components:**
- üõ°Ô∏è `rlm_task_wrapper.sh` —Å –±–µ–ª—ã–º–∏ —Å–ø–∏—Å–∫–∞–º–∏ URL
- üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å—Ç–∞—Ç—É—Å–æ–≤ –∑–∞–¥–∞—á —Å polling
- ‚è±Ô∏è –¢–∞–π–º–∞—É—Ç—ã –∏ retry –ª–æ–≥–∏–∫–∞

---

### Version 2.2.0 (2025-11-20) - üî• Firewall & Network Security

**Features:**
- üîí Wrapper –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ iptables
- üåê –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è firewall –ø—Ä–∞–≤–∏–ª
- üìä –û—Ç–∫—Ä—ã—Ç–∏–µ –ø–æ—Ä—Ç–æ–≤ –¥–ª—è Prometheus, Grafana, Harvest
- üõ°Ô∏è –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞ –∫ Prometheus (localhost + SERVER_IP)

**Security:**
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ—Ä—Ç–æ–≤ (1-65535)
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è IP –∞–¥—Ä–µ—Å–æ–≤
- ‚úÖ –ë–µ–ª—ã–π —Å–ø–∏—Å–æ–∫ –æ–ø–µ—Ä–∞—Ü–∏–π

---

### Version 2.1.0 (2025-11-10) - üé® Grafana API Integration

**Features:**
- üîå –ü–æ–ª–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Grafana API
- üîë –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ service accounts
- üé´ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è bearer —Ç–æ–∫–µ–Ω–æ–≤ –¥–ª—è API
- üìä –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Prometheus datasource —á–µ—Ä–µ–∑ API

**Components:**
- `grafana_wrapper.sh` —Å 9 —Ä–µ–∂–∏–º–∞–º–∏ —Ä–∞–±–æ—Ç—ã
- –í–∞–ª–∏–¥–∞—Ü–∏—è Grafana URL (—Ç–æ–ª—å–∫–æ –ø–æ—Ä—Ç 3000)
- HTTP checks —Ç–æ–ª—å–∫–æ –∫ localhost

---

### Version 2.0.0 (2025-11-01) - üöÄ Jenkins CI/CD Integration

**Breaking Changes:**
- üîÑ –ü–æ–ª–Ω–∞—è –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞ Jenkins Pipeline
- üì¶ –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ CI –∏ CDL —ç—Ç–∞–ø—ã
- üîê –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–µ–∫—Ä–µ—Ç–æ–≤ –∏–∑ Vault —á–µ—Ä–µ–∑ withVault

**Features:**
- üìã –î–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω—ã–π Jenkinsfile —Å 10 —Å—Ç–µ–π–¥–∂–∞–º–∏
- üîê –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å HashiCorp Vault
- üì§ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ SCP
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∏ cleanup

**Pipeline Stages:**
- CI: –û—á–∏—Å—Ç–∫–∞, –≤–∞–ª–∏–¥–∞—Ü–∏—è, Vault, –≥–µ–Ω–µ—Ä–∞—Ü–∏—è launcher'–æ–≤
- CDL: –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ, —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ, –ø—Ä–æ–≤–µ—Ä–∫–∞, cleanup

---

### Version 1.5.0 (2025-10-25) - üõ°Ô∏è Security Wrappers Framework

**Features:**
- üîê –°–æ–∑–¥–∞–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ wrapper'–æ–≤ —Å –±–µ–ª—ã–º–∏ —Å–ø–∏—Å–∫–∞–º–∏
- üìù `config_writer.sh` - –±–µ–∑–æ–ø–∞—Å–Ω–∞—è –∑–∞–ø–∏—Å—å –∫–æ–Ω—Ñ–∏–≥–æ–≤
- üåê –ë–µ–ª—ã–µ —Å–ø–∏—Å–∫–∏ –ø—É—Ç–µ–π –¥–ª—è –∑–∞–ø–∏—Å–∏ —Ñ–∞–π–ª–æ–≤
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –≤—Ö–æ–¥–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

**Security:**
- –ë–µ–ª—ã–π —Å–ø–∏—Å–æ–∫ –ø—É—Ç–µ–π (10 —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤)
- –ó–∞–ø—Ä–µ—Ç –∑–∞–ø–∏—Å–∏ –≤ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

---

### Version 1.4.0 (2025-10-20) - üìä Prometheus & Grafana Configuration

**Features:**
- ‚öôÔ∏è –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ Prometheus –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- üìà –°–æ–∑–¥–∞–Ω–∏–µ scrape jobs –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
- üîí –ù–∞—Å—Ç—Ä–æ–π–∫–∞ mTLS –¥–ª—è Prometheus
- üé® –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Grafana —Å TLS

**Configuration Files:**
- `prometheus.yml` - scrape configs
- `web-config.yml` - TLS –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- `grafana.ini` - server, security, paths

---

### Version 1.3.0 (2025-10-18) - üîê Vault Agent Configuration

**Features:**
- üîë –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å HashiCorp Vault Agent
- üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–µ–∫—Ä–µ—Ç–æ–≤
- üìù Template –º–µ—Ö–∞–Ω–∏–∑–º –¥–ª—è –∫–æ–Ω—Ñ–∏–≥–æ–≤
- üîê AppRole authentication

**Templates:**
- `/opt/vault/conf/data_sec.json`
- `/opt/vault/certs/server_bundle.pem`
- `/opt/vault/certs/ca_chain.crt`

---

### Version 1.2.0 (2025-10-16) - üßπ Cleanup & Prerequisites

**Features:**
- üßπ –§—É–Ω–∫—Ü–∏—è –ø–æ–ª–Ω–æ–π –æ—á–∏—Å—Ç–∫–∏ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —É—Å—Ç–∞–Ω–æ–≤–æ–∫
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (curl, jq, iptables)
- üîç –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–µ—Ç–µ–≤—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- üîå –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ –ø–æ—Ä—Ç–æ–≤

**Functions:**
- `cleanup_all_previous()`
- `check_dependencies()`
- `check_and_close_ports()`
- `detect_network_info()`

---

### Version 1.1.0 (2025-10-15) - üìù Initial Script Structure

**Features:**
- üìã –ë–∞–∑–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞
- üéØ –§—É–Ω–∫—Ü–∏–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- üìä –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –≤—ã–≤–æ–¥ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
- ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

---

### Version 1.0.0 (2025-10-14) - üéâ Project Inception

**Initial Release:**
- üöÄ –°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –ø—Ä–æ–µ–∫—Ç–∞
- üìÅ –ë–∞–∑–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–∞—Ç–∞–ª–æ–≥–æ–≤
- üìñ –ù–∞—á–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- üéØ –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã —Ä–µ—à–µ–Ω–∏—è

---

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

–í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –ø—Ä–æ–µ–∫—Ç –°–±–µ—Ä–±–∞–Ω–∫–∞. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–æ —Ç–æ–ª—å–∫–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º –°–±–µ—Ä–±–∞–Ω–∫–∞ –≤ —Ä–∞–º–∫–∞—Ö —Å–ª—É–∂–µ–±–Ω—ã—Ö –æ–±—è–∑–∞–Ω–Ω–æ—Å—Ç–µ–π.

---

<div align="center">

**–°–æ–∑–¥–∞–Ω–æ —Å ‚ù§Ô∏è –∫–æ–º–∞–Ω–¥–æ–π DevOps**

*–î–ª—è –≤–æ–ø—Ä–æ—Å–æ–≤ –∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π –æ–±—Ä–∞—â–∞–π—Ç–µ—Å—å –≤ –∫–∞–Ω–∞–ª #monitoring-deployment*

</div>
